# 每日进度提取规则 (Daily Progress Extraction Rules)

> **目标**: 建立无幻觉、真实、经过提炼的当日进度记录。

## 1. 目录结构
所有进度文件存放于 `.trae/documents/daily-progress/` 目录下。

## 2. 文件命名规范
*   **规则文件**: `00_Daily_Progress_Rules.md` (本文档)
*   **进度文件**: `YYYY-MM-DD_Progress.md` (例如: `2026-02-17_Progress.md`)
*   **临时汇总**: `temp_logs_YYYY-MM-DD.txt` (仅用于中间步骤，用完即删或保留存档)

## 3. 执行流程 (标准操作程序)

### 步骤 1: 确定时间跨度与起始点
1.  **收集提交**: 获取最近 24-36 小时的 Git 提交记录。
2.  **寻找断点**: 
    - 计算相邻提交的时间间隔。
    - 找到**时间间隔最大**的两个相邻提交。
    - 前一个提交视为"昨日结束"，后一个提交视为"今日开始"。
3.  **确定范围**: 从"今日开始"的提交一直到当前最新提交 (HEAD)。

### 步骤 2: 汇总原始数据
1.  **设置编码 (关键)**: 
    - 必须确保 PowerShell 正确处理 Git 的 UTF-8 输出，否则会出现乱码。
    - **执行命令**:
      ```powershell
      # 1. 设置控制台编码为 UTF-8 (防止读取 Git 输出时乱码)
      [Console]::OutputEncoding = [System.Text.Encoding]::UTF8
      
      # 2. 使用 Out-File 显式指定 UTF-8 编码保存 (防止写入文件时乱码)
      git --no-pager log ... | Out-File -Encoding UTF8 temp_log.txt
      ```
    - **注意**: 严禁使用默认的重定向符号 `>`，因为它可能使用 UTF-16 或系统默认编码 (GBK)。
2.  将该时间范围内的所有提交信息 (`git log`) 导出到一个临时文件。
3.  格式建议包含: Hash, Author, Date, Message, Stat (文件变更统计)。

### 步骤 3: 生成未验证清单 (Draft)
1.  创建一个新的进度文件 (如 `2026-02-17_Progress.md`)。
2.  阅读临时汇总文件，提炼出关键任务点。
3.  **罗列清单**: 
    - 将提炼出的点转换为 Markdown 待办列表 (`- [ ]`)。
    - **时间戳 (必须)**: 每一项必须包含具体的完成时间 (如 `` `14:30` ``)。
    - **排序规则 (关键)**: 虽然可以按模块分类，但**分类内部必须严格按时间顺序 (正序)** 排列，以体现真实的时间流进度感。
4.  **标记状态**: 此时所有项均为**未验证**状态。

### 步骤 4: 验证与修正 (Verify & Refine)
1.  **逐项验证**: 
    - 对照项目实际代码、文件结构或运行结果。
    - 确认该功能/修复是否真实存在且符合描述。
    - **严禁幻觉**: 如果代码中找不到对应实现，必须从清单中移除或标记为"未完成/误报"。
2.  **勾选完成**: 每验证通过一项，将 `- [ ]` 改为 `- [x]`。
3.  **补充细节**: 在验证过程中，如果发现遗漏的细节或副作用，补充到对应条目下。

### 步骤 5: 最终定稿与清理
1.  当所有条目都验证并勾选后，该文件即为当日的**最终进度**。
2.  (可选) 添加"明日计划"或"遗留问题"章节。
3.  **清理临时文件**: 务必删除生成的 `temp_*.txt` 文件，保持目录整洁。

## 4. 示例结构
```markdown
# 2026-02-17 每日进度

## 📅 时间跨度
- **起始提交**: `a1b2c3d` (2026-02-16 10:00)
- **结束提交**: `e5f6g7h` (2026-02-17 22:00)

## ✅ 已验证进度

### 🛠️ 核心模块
- [x] `10:30` **功能A**: 完成了核心逻辑实现 (已验证: `src/core/FeatureA.java`)
- [x] `14:15` **修复B**: 修复了空指针异常

### 🎨 UI 交互
- [x] `11:00` **界面C**: 调整了按钮布局
- [x] `16:20` **动画D**: 优化了过场动画效果
```
