buildscript {
	repositories {
		google()
		jcenter()
		mavenLocal()
		mavenCentral()
		gradlePluginPortal()
		maven { url 'https://maven.aliyun.com/repository/public/' }
		maven { url 'https://maven.aliyun.com/repository/google' }
		maven { url 'https://maven.aliyun.com/repository/jcenter' }
		maven { url 'https://maven.aliyun.com/repository/gradle-plugin' }
		maven { url 'https://maven.aliyun.com/nexus/content/groups/public' }
		maven { url 'https://s01.oss.sonatype.org' }
		maven { url 'https://oss.sonatype.org/content/repositories/snapshots/' }
		maven { url 'https://s01.oss.sonatype.org/content/repositories/snapshots/' }
		maven { url "https://jitpack.io" }
		maven { url 'https://repo1.maven.org/maven2/' }
		maven { url 'https://dl.bintray.com/ppartisan/maven/' }
		maven { url "https://clojars.org/repo/" }
	}
	dependencies {
		classpath 'com.android.tools.build:gradle:8.12.3'
	}
}

allprojects {
	apply plugin: 'eclipse'
	apply plugin: 'idea'
	// This allows you to "Build and run using IntelliJ IDEA", an option in IDEA's Settings.
	idea {
		module {
			outputDir file('build/classes/java/main')
			testOutputDir file('build/classes/java/test')
		}
	}
	tasks.withType(JavaCompile).configureEach {
		options.encoding = "UTF-8"
	}
}

subprojects {
	version = '$projectVersion'
	ext.appName = 'MagicDungeon'
	repositories {
		google()
		jcenter()
		mavenLocal()
		mavenCentral()
		gradlePluginPortal()
		maven { url 'https://maven.aliyun.com/repository/public/' }
		maven { url 'https://maven.aliyun.com/repository/google' }
		maven { url 'https://maven.aliyun.com/repository/jcenter' }
		maven { url 'https://maven.aliyun.com/repository/gradle-plugin' }
		maven { url 'https://maven.aliyun.com/nexus/content/groups/public' }
		maven { url 'https://s01.oss.sonatype.org' }
		maven { url 'https://oss.sonatype.org/content/repositories/snapshots/' }
		maven { url 'https://s01.oss.sonatype.org/content/repositories/snapshots/' }
		maven { url "https://jitpack.io" } // ã€å…³é”®ã€‘æ·»åŠ  JitPack
		maven { url "https://oss.sonatype.org/content/repositories/snapshots/" } // æ·»åŠ å¿«ç…§ä»“åº“
		maven { url "https://oss.sonatype.org/content/repositories/releases/" }
		maven { url 'https://repo1.maven.org/maven2/' }
		maven { url 'https://dl.bintray.com/ppartisan/maven/' }
		maven { url "https://clojars.org/repo/" }
	}

	plugins.withType(JavaPlugin).tap {
		configureEach {
			java {
				sourceCompatibility = JavaVersion.toVersion(project.jdkVersion)
				targetCompatibility = JavaVersion.toVersion(project.jdkVersion)
			}
		}
	}
}

eclipse.project.name = 'MagicDungeon' + '-parent'

// ============================================================
// ç»Ÿä¸€æ„å»ºè°ƒåº¦ä¸­å¿ƒ (Build Orchestration)
// ============================================================

// å¼•å…¥ç‹¬ç«‹çš„å¼•æ“ä»»åŠ¡ç®¡ç†è„šæœ¬
apply from: 'gradle/engine-tasks.gradle'
//apply from: 'gradle/changelog-generator.gradle'

// [æ–°å¢] å¼•å…¥æœ¬åœ°æ–‡æ¡£é¢„è§ˆä»»åŠ¡
apply from: 'gradle/docs-preview.gradle'

// [æ–°å¢] å¼•å…¥ç‰ˆæœ¬ç®¡ç†ä»»åŠ¡
apply from: 'gradle/versioning.gradle'

apply from: 'gradle/publish-docs.gradle'
//apply from: 'gradle/publish-template.gradle'
//
// [æ–°å¢] å¼•å…¥ jpackage æ‰“åŒ…ä»»åŠ¡ (åœ¨ lwjgl3 æ¨¡å—ä¸­å®šä¹‰ï¼Œè¿™é‡Œåšä¸ªåˆ«å)
task oneClickRelease {
    group = "distribution"
    description = "ä¸€é”®æ„å»º Jar -> jpackage -> å•æ–‡ä»¶ Exe (éœ€è¦é…ç½® Enigma)"

    // ä¾èµ– lwjgl3 æ¨¡å—çš„æ‰“åŒ…ä»»åŠ¡
    dependsOn ':lwjgl3:packageSingleExe'

    doLast {
        println "--------------------------------------------------"
        println "ğŸ‰ å‘å¸ƒæµç¨‹ç»“æŸ"
        println "--------------------------------------------------"
    }
}

// åˆ«åä»»åŠ¡ï¼šå…è®¸ç›´æ¥ä½¿ç”¨ gradlew packageSingleExe
task packageSingleExe {
    group = "distribution"
    description = "Package single exe (Alias for :lwjgl3:packageSingleExe)"
    dependsOn ':lwjgl3:packageSingleExe'
}
